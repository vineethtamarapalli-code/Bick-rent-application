<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCD - Bike Rentals</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        /* Use Inter as the default font */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Lighter gray background */
        }

        /* Custom gradient for buttons and highlights */
        .btn-gradient {
            background-image: linear-gradient(to right, #4f46e5, #818cf8);
            transition: all 0.3s ease;
        }
        .btn-gradient:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
        }

        /* Card hover effect */
        .bike-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .bike-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* Form input styling */
        .form-input {
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        .form-input:focus {
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }
        
        /* Modal animation */
        .modal-enter {
            animation: fadeIn 0.3s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Error message styling */
        .error-message {
            animation: slideDown 0.3s ease-out forwards;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50">

    <!-- Navigation Bar -->
    <nav class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Left Side: Title -->
                <div class="flex-shrink-0">
                    <a href="#" id="home-link-nav" class="text-2xl font-extrabold text-gray-900 tracking-tight">MCD</a>
                </div>

                <!-- Right Side: Navigation Buttons -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-center space-x-4">
                        <a href="#" id="home-link" class="text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">Home</a>
                        
                        <a href="#" id="login-nav-link" data-no-auth class="btn-gradient text-white px-4 py-2 rounded-md text-xs font-semibold shadow-md">Login</a>
                        
                        <a href="#" id="my-profile-link" data-auth-required class="hidden text-gray-600 hover:text-indigo-600 px-3 py-2 rounded-md text-sm font-medium transition-colors">My Profile</a>
                    </div>
                </div>

                <!-- Mobile Menu Button -->
                <div class="-mr-2 flex md:hidden">
                    <button type="button" id="mobile-menu-button" class="bg-gray-100 inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-indigo-500">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#" id="home-link-mobile" class="text-gray-600 hover:bg-gray-100 block px-3 py-2 rounded-md text-base font-medium">Home</a>
                <a href="#" id="login-nav-link-mobile" data-no-auth class="text-gray-600 hover:bg-gray-100 block px-3 py-2 rounded-md text-base font-medium">Login</a>
                <a href="#" id="my-profile-link-mobile" data-auth-required class="hidden text-gray-600 hover:bg-gray-100 block px-3 py-2 rounded-md text-base font-medium">My Profile</a>
            </div>
        </div>
    </nav>

    <!-- Page Content -->
    <main>
        <!-- Home Page Section -->
        <div id="home-section" class="max-w-7xl mx-auto py-12 sm:px-6 lg:px-8">
             <div id="rental-listings-container" class="px-4 py-6 sm:px-0 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                 <div id="initial-home-message" class="hidden col-span-full border-2 border-dashed border-gray-300 rounded-lg h-96 flex items-center justify-center text-center">
                     <h1 class="text-xl text-gray-500 font-medium">No bikes are available for rent right now.</h1>
                 </div>
             </div>
        </div>

        <!-- My Profile Section -->
        <div id="my-profile-section" class="hidden max-w-7xl mx-auto py-12 sm:px-6 lg:px-8">
            <div class="space-y-12">
                <!-- Profile Details Card -->
                <div class="bg-white p-8 rounded-2xl shadow-xl">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Your Profile</h2>
                    <form id="profile-form" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="profile-first-name" class="block text-sm font-medium text-gray-700">First Name</label>
                                <input type="text" id="profile-first-name" disabled class="form-input mt-1 block w-full bg-gray-100 rounded-md border-gray-300">
                            </div>
                            <div>
                                <label for="profile-last-name" class="block text-sm font-medium text-gray-700">Last Name</label>
                                <input type="text" id="profile-last-name" disabled class="form-input mt-1 block w-full bg-gray-100 rounded-md border-gray-300">
                            </div>
                            <div class="md:col-span-2">
                                <label for="profile-email" class="block text-sm font-medium text-gray-700">Email Address</label>
                                <input type="email" id="profile-email" disabled class="form-input mt-1 block w-full bg-gray-100 rounded-md border-gray-300">
                            </div>
                            <div class="md:col-span-2">
                                <label for="profile-phone" class="block text-sm font-medium text-gray-700">Phone Number</label>
                                <input type="tel" id="profile-phone" disabled class="form-input mt-1 block w-full bg-gray-100 rounded-md border-gray-300">
                            </div>
                        </div>
                        <div class="flex justify-end items-center pt-4 space-x-4">
                            <button type="button" id="logout-btn-profile" class="bg-red-500 text-white px-5 py-2.5 rounded-md text-sm font-semibold shadow-md hover:bg-red-600 transition-all">Logout</button>
                            <button type="button" id="edit-profile-btn" class="btn-gradient text-white px-5 py-2.5 rounded-md text-sm font-semibold shadow-md">Edit Profile</button>
                        </div>
                    </form>
                </div>

                <!-- My Listings Section -->
                <div>
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Your Listings</h2>
                        <button id="add-new-bike-btn" class="btn-gradient text-white px-5 py-2.5 rounded-md text-sm font-semibold shadow-md">Add New Bike</button>
                    </div>
                    <div id="my-listings-container" class="px-4 py-6 sm:px-0 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div id="initial-my-listings-message" class="col-span-full border-2 border-dashed border-gray-300 rounded-lg h-96 flex items-center justify-center text-center">
                            <h1 class="text-xl text-gray-500 font-medium">You haven't added any bikes for rent yet.</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login & Signup Common Container -->
        <div id="auth-container" class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
            <!-- Login Page Section -->
            <div id="login-section" class="hidden max-w-md w-full space-y-8">
                <div class="bg-white p-8 rounded-2xl shadow-xl">
                    <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Welcome Back!</h2>
                    <form id="login-form" class="mt-8 space-y-6">
                        <div id="login-error-message" class="hidden error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative" role="alert"></div>
                        <div class="space-y-4">
                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-envelope text-gray-400"></i></span>
                                <input id="login-email" name="email" type="email" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Email Address (e.g., john@email.com)">
                            </div>
                            <div class="relative">
                                <span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-lock text-gray-400"></i></span>
                                <input id="login-password" name="password" type="password" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Password">
                                <span class="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer"><i class="fas fa-eye text-gray-400" id="toggleLoginPassword"></i></span>
                            </div>
                        </div>
                         <div class="flex items-center justify-end">
                            <div class="text-sm">
                                <a href="#" id="forgot-password-link" class="font-medium text-indigo-600 hover:text-indigo-500"> Forgot your password? </a>
                            </div>
                        </div>
                        <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white btn-gradient focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Login</button>
                        <p class="mt-2 text-center text-sm text-gray-600">Don't have an account? <a href="#" id="go-to-signup" class="font-medium text-indigo-600 hover:text-indigo-500">Sign up</a></p>
                    </form>
                </div>
            </div>

            <!-- Sign Up Page Section -->
            <div id="signup-section" class="hidden max-w-md w-full space-y-8">
                <div class="bg-white p-8 rounded-2xl shadow-xl">
                    <h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Create Your Account</h2>
                    <form id="signup-form" class="mt-8 space-y-6">
                        <div id="signup-error-message" class="hidden error-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg relative" role="alert"></div>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-4">
                                <div class="relative w-1/2"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-user text-gray-400"></i></span><input id="signup-first-name" name="first-name" type="text" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="First Name"></div>
                                <div class="relative w-1/2"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-user text-gray-400"></i></span><input id="signup-last-name" name="last-name" type="text" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Last Name"></div>
                            </div>
                            <div class="relative"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-envelope text-gray-400"></i></span><input id="signup-email-address" name="email" type="email" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Email address"></div>
                            <div class="flex items-center space-x-2">
                                <div class="relative w-full"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-phone text-gray-400"></i></span><input id="signup-phone" name="phone" type="tel" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Phone Number"></div>
                                <button type="button" id="send-otp-btn" class="px-4 py-3 bg-indigo-500 text-white rounded-md text-xs font-semibold hover:bg-indigo-600 transition-all whitespace-nowrap">Send OTP</button>
                            </div>
                            <div id="otp-section" class="hidden relative"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-key text-gray-400"></i></span><input id="signup-otp" name="otp" type="text" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Enter OTP (e.g., 123456)"></div>
                            <div class="relative"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-lock text-gray-400"></i></span><input id="signup-password" name="password" type="password" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Password"><span class="absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer"><i class="fas fa-eye text-gray-400" id="toggleSignupPassword"></i></span></div>
                            <div class="relative"><span class="absolute inset-y-0 left-0 flex items-center pl-3"><i class="fas fa-check-circle text-gray-400"></i></span><input id="signup-confirm-password" name="confirm-password" type="password" required class="form-input pl-10 appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none sm:text-sm" placeholder="Confirm Password"></div>
                        </div>
                        <button type="submit" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white btn-gradient focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Sign up</button>
                        <p class="mt-2 text-center text-sm text-gray-600">Already have an account? <a href="#" id="go-to-login" class="font-medium text-indigo-600 hover:text-indigo-500">Login</a></p>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- Add to Rent Section -->
        <div id="add-rent-section" class="hidden min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
             <div class="max-w-2xl w-full space-y-8 bg-white p-10 rounded-2xl shadow-xl">
                 <h2 class="text-center text-3xl font-extrabold text-gray-900">List Your Bike for Rent</h2>
                 <form id="add-rent-form" class="mt-8 space-y-6">
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <input type="text" id="owner-full-name" required class="form-input w-full px-3 py-3 border-gray-300 rounded-md" placeholder="Full Name (Owner)">
                         <input type="tel" id="owner-phone" required class="form-input w-full px-3 py-3 border-gray-300 rounded-md" placeholder="Phone Number">
                         <input type="text" id="bike-name" required class="form-input w-full px-3 py-3 border-gray-300 rounded-md" placeholder="Bike Name">
                         <input type="text" id="bike-no" required class="form-input w-full px-3 py-3 border-gray-300 rounded-md" placeholder="Bike No.">
                         <div class="md:col-span-2"><input type="text" id="owner-address" required class="form-input w-full px-3 py-3 border-gray-300 rounded-md" placeholder="Address"></div>
                         <div><label for="owner-image" class="block text-sm font-medium text-gray-700 mb-1">Owner's Image</label><input type="file" id="owner-image" accept="image/*" required class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"></div>
                         <div><label for="bike-pic" class="block text-sm font-medium text-gray-700 mb-1">Bike's Picture</label><input type="file" id="bike-pic" accept="image/*" required class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"></div>
                     </div>
                     <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white btn-gradient focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Submit Listing</button>
                 </form>
             </div>
        </div>
    </main>
    
    <!-- Modals -->
    <!-- Sign Up Success Modal -->
    <div id="signup-success-section" class="hidden fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="modal-enter bg-white p-8 rounded-2xl shadow-xl w-full max-w-md text-center">
            <div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100">
                <svg class="h-8 w-8 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
            </div>
            <h3 class="text-2xl leading-6 font-bold text-gray-900 mt-5">Sign Up Successful!</h3>
            <div class="mt-4 px-4 py-3">
                <p class="text-md text-gray-600">
                    You have successfully created your account. Please proceed to the login page.
                </p>
            </div>
            <div class="mt-5">
                <button id="go-to-login-from-signup" class="w-full py-3 px-4 rounded-md shadow-sm text-sm font-medium text-white btn-gradient">
                    Go to Login
                </button>
            </div>
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- Page Section Elements ---
        const homeSection = document.getElementById('home-section');
        const authContainer = document.getElementById('auth-container');
        const loginSection = document.getElementById('login-section');
        const signupSection = document.getElementById('signup-section');
        const addRentSection = document.getElementById('add-rent-section');
        const myProfileSection = document.getElementById('my-profile-section');
        const signupSuccessSection = document.getElementById('signup-success-section');

        // --- App State ---
        let isLoggedIn = false;
        let currentUser = null; // Will store the first name for greetings
        let currentUserEmail = null; // Will store the email for identification
        let bikeListings = [];
        let userAccounts = { 
            "john@email.com": { password: "password123", firstName: "John", lastName: "Doe", phone: "123-456-7890" }, 
            "jane@email.com": { password: "password123", firstName: "Jane", lastName: "Smith", phone: "098-765-4321" } 
        };

        // --- Sample Data ---
        const sampleBikes = [
            { listingId: 'bike-1', ownerUsername: 'john@email.com', ownerName: 'John Doe', ownerPhone: '123-456-7890', bikeName: 'Mountain Explorer', bikeNo: 'ME-1234', ownerAddress: '123 Pine St, Hill Valley', ownerImageUrl: 'https://placehold.co/100x100/EFEFEF/333333?text=JD', bikePicUrl: 'https://images.unsplash.com/photo-1576426863875-c21f1e40a295?q=80&w=2070&auto=format&fit=crop' },
            { listingId: 'bike-2', ownerUsername: 'jane@email.com', ownerName: 'Jane Smith', ownerPhone: '098-765-4321', bikeName: 'City Cruiser', bikeNo: 'CC-5678', ownerAddress: '456 Oak Ave, Metro City', ownerImageUrl: 'https://placehold.co/100x100/EFEFEF/333333?text=JS', bikePicUrl: 'https://images.unsplash.com/photo-1558981852-426c6c22a060?q=80&w=2071&auto=format&fit=crop' },
            { listingId: 'bike-3', ownerUsername: 'john@email.com', ownerName: 'John Doe', ownerPhone: '123-456-7890', bikeName: 'Speed Demon', bikeNo: 'SD-9101', ownerAddress: '123 Pine St, Hill Valley', ownerImageUrl: 'https://placehold.co/100x100/EFEFEF/333333?text=JD', bikePicUrl: 'https://images.unsplash.com/photo-1575585254345-19de12849c50?q=80&w=1931&auto=format&fit=crop' }
        ];

        // --- UI Elements ---
        const rentalListingsContainer = document.getElementById('rental-listings-container');
        const initialHomeMessage = document.getElementById('initial-home-message');
        const myListingsContainer = document.getElementById('my-listings-container');
        const initialMyListingsMessage = document.getElementById('initial-my-listings-message');
        const loginForm = document.getElementById('login-form');
        const signupForm = document.getElementById('signup-form');
        const sendOtpBtn = document.getElementById('send-otp-btn');
        const otpSection = document.getElementById('otp-section');
        const goToLoginFromSignupBtn = document.getElementById('go-to-login-from-signup');
        const loginErrorMessage = document.getElementById('login-error-message');
        const signupErrorMessage = document.getElementById('signup-error-message');
        const forgotPasswordLink = document.getElementById('forgot-password-link');
        const editProfileBtn = document.getElementById('edit-profile-btn');
        const profileFormInputs = document.querySelectorAll('#profile-form input');
        const addNewBikeBtn = document.getElementById('add-new-bike-btn');
        const logoutBtnProfile = document.getElementById('logout-btn-profile');


        // --- Page Switching Function ---
        function showPage(pageId) {
            const isAuthPage = pageId === 'login-section' || pageId === 'signup-section';
            [homeSection, authContainer, addRentSection, myProfileSection].forEach(section => section?.classList.add('hidden'));
            [loginSection, signupSection].forEach(section => section?.classList.add('hidden'));

            if (isAuthPage) {
                authContainer.classList.remove('hidden');
                document.getElementById(pageId).classList.remove('hidden');
            } else {
                document.getElementById(pageId)?.classList.remove('hidden');
            }
        }

        // --- Auth State UI Updater ---
        function updateAuthStateUI() {
            document.querySelectorAll('[data-auth-required]').forEach(el => el.classList.toggle('hidden', !isLoggedIn));
            document.querySelectorAll('[data-no-auth]').forEach(el => el.classList.toggle('hidden', isLoggedIn));
        }

        // --- Render Functions ---
        const createCardHTML = (bike, buttonType) => `
            <div class="bg-white rounded-xl shadow-md overflow-hidden bike-card" data-listing-id="${bike.listingId}">
                <img src="${bike.bikePicUrl}" alt="${bike.bikeName}" class="w-full h-56 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x300/EFEFEF/333333?text=Image+Error';">
                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-900 mb-1">${bike.bikeName}</h3>
                    <p class="text-sm text-gray-500 mb-4">Bike No: ${bike.bikeNo}</p>
                    <div class="border-t border-gray-200 pt-4 mb-4">
                        <div class="flex items-center">
                            <img src="${bike.ownerImageUrl}" alt="${bike.ownerName}" class="w-12 h-12 rounded-full object-cover mr-4">
                            <div>
                                <p class="font-semibold text-gray-800">${bike.ownerName}</p>
                                <p class="text-xs text-gray-500">${bike.ownerAddress}</p>
                            </div>
                        </div>
                    </div>
                    ${buttonType === 'rent' ? 
                        `<button class="take-to-rent-btn w-full py-2.5 px-4 rounded-lg text-sm font-semibold text-white btn-gradient shadow-md">Take to Rent</button>` :
                        `<button class="delete-listing-btn w-full py-2.5 px-4 rounded-lg text-sm font-semibold text-white bg-red-500 hover:bg-red-600 shadow-md transition-all">Delete Listing</button>`
                    }
                </div>
            </div>
        `;

        function renderBikes(container, messageEl, bikes, buttonType) {
            const currentContent = Array.from(container.children).filter(el => !el.hasAttribute('id'));
            currentContent.forEach(el => el.remove());

            if (bikes.length === 0) {
                messageEl.classList.remove('hidden');
                messageEl.classList.add('flex');
            } else {
                messageEl.classList.add('hidden');
                messageEl.classList.remove('flex');
                bikes.forEach(bike => container.insertAdjacentHTML('beforeend', createCardHTML(bike, buttonType)));
            }
        }
        
        // --- Helper for showing errors ---
        function showAuthError(element, message) {
            element.textContent = message;
            element.classList.remove('hidden');
        }
        function hideAuthError(element) {
            element.classList.add('hidden');
        }

        // --- Password Toggle ---
        function setupPasswordToggle(toggleId, passwordId) {
            const toggle = document.getElementById(toggleId);
            const password = document.getElementById(passwordId);
            if(toggle && password){
                toggle.addEventListener('click', function () {
                    const type = password.getAttribute('type') === 'password' ? 'text' : 'password';
                    password.setAttribute('type', type);
                    this.classList.toggle('fa-eye-slash');
                });
            }
        }

        // --- Profile Page Logic ---
        function populateProfile() {
            if (isLoggedIn && userAccounts[currentUserEmail]) {
                const userData = userAccounts[currentUserEmail];
                document.getElementById('profile-first-name').value = userData.firstName;
                document.getElementById('profile-last-name').value = userData.lastName;
                document.getElementById('profile-email').value = currentUserEmail;
                document.getElementById('profile-phone').value = userData.phone;
            }
        }

        // --- Initial Load ---
        function initializeApp() {
            bikeListings = [...sampleBikes];
            renderBikes(rentalListingsContainer, initialHomeMessage, bikeListings, 'rent');
            updateAuthStateUI();
            showPage('home-section');
            setupPasswordToggle('toggleLoginPassword', 'login-password');
            setupPasswordToggle('toggleSignupPassword', 'signup-password');
        }
        
        initializeApp();

        // --- Event Listeners ---
        // Navigation
        document.getElementById('home-link-nav').addEventListener('click', (e) => { e.preventDefault(); showPage('home-section'); });
        document.getElementById('home-link').addEventListener('click', (e) => { e.preventDefault(); showPage('home-section'); });
        document.getElementById('home-link-mobile').addEventListener('click', (e) => { e.preventDefault(); showPage('home-section'); });
        document.getElementById('login-nav-link').addEventListener('click', (e) => { e.preventDefault(); showPage('login-section'); });
        document.getElementById('login-nav-link-mobile').addEventListener('click', (e) => { e.preventDefault(); showPage('login-section'); });
        
        document.getElementById('my-profile-link').addEventListener('click', (e) => { 
            e.preventDefault(); 
            populateProfile();
            const userBikes = bikeListings.filter(bike => bike.ownerUsername === currentUserEmail);
            renderBikes(myListingsContainer, initialMyListingsMessage, userBikes, 'delete');
            showPage('my-profile-section'); 
        });
        document.getElementById('my-profile-link-mobile').addEventListener('click', (e) => { 
            e.preventDefault(); 
            populateProfile();
            const userBikes = bikeListings.filter(bike => bike.ownerUsername === currentUserEmail);
            renderBikes(myListingsContainer, initialMyListingsMessage, userBikes, 'delete');
            showPage('my-profile-section'); 
        });
        
        document.getElementById('go-to-signup').addEventListener('click', (e) => { e.preventDefault(); showPage('signup-section'); });
        document.getElementById('go-to-login').addEventListener('click', (e) => { e.preventDefault(); showPage('login-section'); });

        // Login/Logout
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            hideAuthError(loginErrorMessage);
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            if (userAccounts[email] && userAccounts[email].password === password) {
                isLoggedIn = true;
                currentUser = userAccounts[email].firstName;
                currentUserEmail = email;
                updateAuthStateUI();
                showPage('home-section');
                loginForm.reset();
            } else {
                showAuthError(loginErrorMessage, 'Invalid email or password.');
            }
        });

        forgotPasswordLink.addEventListener('click', (e) => {
            e.preventDefault();
            loginErrorMessage.classList.remove('bg-red-100', 'border-red-400', 'text-red-700');
            loginErrorMessage.classList.add('bg-green-100', 'border-green-400', 'text-green-700');
            showAuthError(loginErrorMessage, 'Password reset instructions sent to your email.');
             setTimeout(() => {
                loginErrorMessage.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                loginErrorMessage.classList.remove('bg-green-100', 'border-green-400', 'text-green-700');
             }, 5000)
        });

        const logoutUser = (e) => {
            e.preventDefault();
            isLoggedIn = false;
            currentUser = null;
            currentUserEmail = null;
            updateAuthStateUI();
            showPage('home-section');
        };

        [logoutBtnProfile].forEach(link => {
            link.addEventListener('click', logoutUser);
        });

        // Signup Logic
        sendOtpBtn.addEventListener('click', () => {
            otpSection.classList.remove('hidden');
            sendOtpBtn.textContent = 'Resend';
            sendOtpBtn.disabled = true;
            sendOtpBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
            setTimeout(() => {
                sendOtpBtn.disabled = false;
                sendOtpBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
            }, 30000);
        });

        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            hideAuthError(signupErrorMessage);
            const otp = document.getElementById('signup-otp').value;
            const firstName = document.getElementById('signup-first-name').value;
            const lastName = document.getElementById('signup-last-name').value;
            const phone = document.getElementById('signup-phone').value;
            const email = document.getElementById('signup-email-address').value;
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('signup-confirm-password').value;

            if (password !== confirmPassword) {
                showAuthError(signupErrorMessage, 'Passwords do not match.');
                return;
            }

            if (userAccounts[email]) {
                showAuthError(signupErrorMessage, 'An account with this email already exists.');
                return;
            }

            if (otp === '123456') {
                userAccounts[email] = { password, firstName, lastName, phone };
                signupSuccessSection.classList.remove('hidden');
                signupForm.reset();
                otpSection.classList.add('hidden');
            } else {
                showAuthError(signupErrorMessage, 'Invalid OTP. Please try again.');
            }
        });

        goToLoginFromSignupBtn.addEventListener('click', () => {
            signupSuccessSection.classList.add('hidden');
            showPage('login-section');
        });

        // Profile Page Logic
        editProfileBtn.addEventListener('click', () => {
            const isEditing = editProfileBtn.textContent === 'Save Changes';
            if (isEditing) {
                // Save logic
                const updatedData = {
                    ...userAccounts[currentUserEmail],
                    firstName: document.getElementById('profile-first-name').value,
                    lastName: document.getElementById('profile-last-name').value,
                    phone: document.getElementById('profile-phone').value,
                };
                userAccounts[currentUserEmail] = updatedData;
                currentUser = updatedData.firstName; // Update greeting name
                updateAuthStateUI();

                profileFormInputs.forEach(input => {
                    if (input.id !== 'profile-email') {
                         input.disabled = true;
                         input.classList.add('bg-gray-100');
                    }
                });
                editProfileBtn.textContent = 'Edit Profile';
            } else {
                // Edit logic
                profileFormInputs.forEach(input => {
                    if (input.id !== 'profile-email') { // Don't allow email editing
                        input.disabled = false;
                        input.classList.remove('bg-gray-100');
                    }
                });
                editProfileBtn.textContent = 'Save Changes';
            }
        });
        
        addNewBikeBtn.addEventListener('click', () => {
            showPage('add-rent-section');
        });

        // Add to Rent Form
        document.getElementById('add-rent-form').addEventListener('submit', (e) => {
            e.preventDefault();
            if (!isLoggedIn) { showPage('login-section'); return; }
            const newBike = {
                listingId: `bike-${Date.now()}`, ownerUsername: currentUserEmail, ownerName: document.getElementById('owner-full-name').value, ownerPhone: document.getElementById('owner-phone').value, bikeName: document.getElementById('bike-name').value, bikeNo: document.getElementById('bike-no').value, ownerAddress: document.getElementById('owner-address').value, ownerImageUrl: document.getElementById('owner-image').files[0] ? URL.createObjectURL(document.getElementById('owner-image').files[0]) : 'https://placehold.co/100x100/EFEFEF/333333?text=Owner', bikePicUrl: document.getElementById('bike-pic').files[0] ? URL.createObjectURL(document.getElementById('bike-pic').files[0]) : 'https://placehold.co/400x300/EFEFEF/333333?text=Bike+Pic'
            };
            bikeListings.push(newBike);
            renderBikes(rentalListingsContainer, initialHomeMessage, bikeListings, 'rent');
            e.target.reset();
            showPage('home-section');
        });

        // Delete Listing
        myListingsContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('delete-listing-btn')) {
                const cardToDelete = e.target.closest('[data-listing-id]');
                const listingId = cardToDelete.dataset.listingId;
                bikeListings = bikeListings.filter(bike => bike.listingId !== listingId);
                renderBikes(rentalListingsContainer, initialHomeMessage, bikeListings, 'rent');
                const userBikes = bikeListings.filter(bike => bike.ownerUsername === currentUserEmail);
                renderBikes(myListingsContainer, initialMyListingsMessage, userBikes, 'delete');
            }
        });

        // Mobile Menu
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        if(mobileMenuButton && mobileMenu){
            const hamburgerIcon = mobileMenuButton.querySelector('svg:first-child');
            const closeIcon = mobileMenuButton.querySelector('svg:last-child');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                hamburgerIcon.classList.toggle('hidden');
                closeIcon.classList.toggle('hidden');
            });
        }
    });
    </script>
</body>
</html>
